<ng-template #groupFields let-group="group">
    <div [formGroup]="group">
        <div><span class="text-primary font-bold">Grupo: </span> {{group.value.name}}</div>
        <div class="grid grid-cols-3 p-3 gap-x-3" formArrayName="fields">
            <div *ngFor="let field of getFieldsControls(group).controls; let j= index" formGroupName="{{j}}">
                <div class="flex flex-col m-3">
                    <label>{{field.value.label}}</label>
                    <input pInputText formControlName="value">
                </div>
            </div>
        </div>
    </div>
</ng-template>

<!-- Templates para los campos

<ng-template #calendar let-field="field">
    <label for="icon">{{ field.label }}</label>
    <p-calendar [showIcon]="true" placeholder="Seleccione {{field.label.toLowerCase()}}" [style]="{'width':'100%'}"></p-calendar>
</ng-template>

<ng-template #dropDown let-field="field">
    <label>{{ field.label }}</label>
    <p-dropdown [options]="optionsSelect" optionLabel="name" class="block" placeholder="Seleccione {{field.label.toLowerCase()}}" [style]="{'width':'100%', 'margin-bottom': '27px'}"></p-dropdown>
</ng-template>

<ng-template #inputText let-field="field">
    <label>{{ field.label }}</label>
    <input type="text" pInputText class="block" placeholder="Ingrese {{field.label.toLowerCase()}}" [style]="{'width':'100%', 'margin-bottom': '27px'}" required> 
</ng-template>

<div class="flex flex-col gap-10 mb-20">
    <div *ngFor="let group of productPolicyData" class="grid grid-cols-3 gap-10 bg-white rounded-lg p-10 ml-10 mr-10 shadow-lg">
        <div class="w-full col-span-3 text-5xl text-primary font-bold">{{group.name}}</div>
        <div *ngFor="let field of group.fields" class="w-full">
            <ng-container
                *ngTemplateOutlet="{'Calendar': calendar, 'List box': dropDown, 'Text box': inputText}[field.dataTypeGui] context: {field: field}"
            ></ng-container>
        </div>
    </div>
</div>
-->
<div class="p-5">
    <span class="text-4xl font-bold">Renovación de póliza</span>
    <form [formGroup]="formPolicy" class="mt-5 bg-white rounded-xl p-3">
         

        <div>
            <span>Datos de póliza</span>
            <div formArrayName="policyData">
                <div class="p-5" *ngFor="let group of policyDataControls.controls; let i = index" formGroupName="{{i}}">
                    <ng-container *ngTemplateOutlet="groupFields;context:{group: group}"></ng-container>
                </div>
            </div>
        </div>
        <div>
            <span>Datos del riesgo</span>
            <div formArrayName="riskData">
                <p-tabView [scrollable]="true">
                    <p-tabPanel [header]="risk.value.name" *ngFor="let risk of riskDataControls.controls; let i = index" [selected]="i == 0" formGroupName="{{i}}">
                        <div formArrayName="complementaryData">
                            <div class="p-5" *ngFor="let group of getGroupsControls(risk).controls; let i = index" formGroupName="{{i}}">
                                <ng-container *ngTemplateOutlet="groupFields;context:{group: group}"></ng-container>
                            </div>
                        </div>
                    </p-tabPanel>
                </p-tabView>
            </div>
        </div>
    </form>
</div>
